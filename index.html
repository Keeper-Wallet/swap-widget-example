<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Keeper Swap Widget</title>

    <style>
      body {
        background: #f2f2f2;
        font-family: Helvetica;
      }

      .examples {
        display: grid;
        gap: 20px;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      }
    </style>

    <script src="https://swap-widget.keeper-wallet.app/lib/swap-widget.umd.js"></script>

<script>
      function viewSource(elem, code, lines) { 
        document.getElementById(elem).innerHTML = '<textarea rows="' + lines +'" style="width:100%">' + code + '</textarea>'
      };
    </script>

</head>
  <body>
    <h1>Keeper Swap Widget</h1>

    <p>Keeper Swap Widget provides users of your website with a handy tool for exchanging tokens of the Waves ecosystem at the best price. The widget displays all exchange options and suggests the most profitable one in real time. Check the <a href="#demo">Demo</a>!</p>

    <p>By default, the widget uses built-in <a href="https://docs.waves.tech/en/building-apps/waves-api-and-sdk/client-libraries/signer">Signer</a> to connect a user wallet: Keeper, Waves.Exchange, or Ledger. However, if Signer is already implemented on your website, you can pass the Signer object and the user address to the widget so the user don't have to log in twice.</p>

    <p>Whatâ€™s more, you can become our partner and receive a portion of fee from each exchange made in Keeper Swap Widget embedded in your website.</p>

    <ul>
      <li><a href="#earn">Earn with Keeper Swap Widget</a></li>
      <li><a href="#get-started">How to embed widget</a></li>
      <li><a href="#settings">Widget settings</a></li>
      <li><a href="#demo">Demo</a></li>
      <li><a href="#functions">Functions</a></li>
    </ul>

    <h2 id="earn">Earn with Keeper Swap Widget</h2>

    <p>Keeper Swap Widget charges a fee for each exchange: 0.1% of the output amount. You can get a significant part of that fee. At the start, we pay 50% of fees to our partners!</p>

    <p>How to become a partner:</p>

    <ol>
      <li><a>Contact us</a> to register your referral key.</li>
      <li>Embed the widget in your website and specify the key in widget settings.</li>
      <li>Enjoy your income!</li>
    </ol>

    <h2 id="get-started">How to embed widget</h2>

    <ol>
      <li>Add the script to your site:
        <code><pre>&lt;script src="https://swap-widget.keeper-wallet.app/lib/swap-widget.umd.js"&gt;&lt;/script&gt;</pre></code>
      </li>
      <li>Set up the widget:
        <code><pre>KeeperSwapWidget.create( html-element, { widget-settings } )</pre></code>
      </li>
      <li>The widget is ready to use!</li>
    </ol>

    <h2 id="settings">Widget settings</h2>
    <ul>
      <li>Referrer</li>
      <li>Dark theme</li>
      <li>Initial asset pair</li>
      <li>List of assets to swap to: for example, you can allow users to buy the token of your project only</li>
      <li>User wallet: the Signer object and the user address</li>
    </ul>

    <h2 id="demo">Demo</h2>

    <div class="examples">
      <div>
        <h3>Default layout</h3>

        <div id="swap-widget-default"></div>

        <script>
          KeeperSwapWidget.create(
            document.getElementById('swap-widget-default')
          );
        </script>

        <form><input type="button" value="View code sample" onClick="viewSource('source-default','KeeperSwapWidget\.create\(\n\ \ document\.getElementById\(\'\.\.\.\'\)\n\ \ \{\n\ \ \ \ referrer\: \'...\'\,\n\ \ \}\n\);', 8)" ></form>

        <div id="source-default"></div>

      </div>

      <div>
        <h3>Dark theme</h3>

        <div id="swap-widget-dark"></div>

        <script>
          KeeperSwapWidget.create(document.getElementById('swap-widget-dark'), {
            theme: 'dark',
          });
        </script>

       <form><input type="button" value="View code sample" onClick="viewSource('source-dark','KeeperSwapWidget\.create\(\n\ \ document\.getElementById\(\'\.\.\.\'\),\n\ \ \{\n\ \ \ \ theme\: \'dark\'\,\n\ \ \ \ referrer\: \'...\'\,\n\ \ \}\n\);', 8)" ></form>

       <div id="source-dark"></div>

      </div>

      <div>
        <h3>Initial asset pair</h3>

        <div id="swap-widget-with-initial-pair"></div>

        <script>
          KeeperSwapWidget.create(
            document.getElementById('swap-widget-with-initial-pair'),
            {
              initialFromAssetId:
                '34N9YcEETLWn93qYQ64EsP1x89tSruJU44RrEMSXXEPJ',
              initialToAssetId: '8LQW8f7P5d5PZM7GtZEBgaqRPGSzS3DfPuiXrURJ4AJS',
            }
          );
        </script>

        <form><input type="button" value="View code sample" onClick="viewSource('source-initial-pair','KeeperSwapWidget\.create\(\n\ \ document\.getElementById\(\'\.\.\.\'\),\n\ \ \{\n\ \ \ \ initialFromAssetId\: \'...\'\,\n\ \ \ \ initialToAssetId\: \'...\'\,\n\ \ \ \ referrer\: \'...\'\,\n\ \ \}\n\);', 8)" ></form>

        <div id="source-initial-pair"></div>

      </div>

      <div>
        <h3>Assets to swap to</h3>

        <div id="swap-widget-with-to-asset-ids"></div>

        <script>
          KeeperSwapWidget.create(
            document.getElementById('swap-widget-with-to-asset-ids'),
            {
              toAssetIds: [
                'C1iWsKGqLwjHUndiQ7iXpdmPum9PeCDFfyXBdJJosDRS',
                'BwCk5zUMTuYtFFu3euo3g6Fwdk7TALrr5C8wvdzps8R5',
                'D4TPjtzpsDEJFS1pUAkvh1tJJJMNWGcSrds9sveBoQka',
              ],
            }
          );
        </script>

        <form><input type="button" value="View code sample" onClick="viewSource('source-to-assets','KeeperSwapWidget\.create\(\n\ \ document\.getElementById\(\'\.\.\.\'\),\n\ \ \{\n\ \ \ \ toAssetIds\: \[\'...\'\, ...\],\n\ \ \ \ referrer\: \'...\'\,\n\ \ \}\n\);', 8)" ></form>

        <div id="source-to-assets"></div>

      </div>

      <div>
        <h3>One asset to swap to</h3>

        <div id="swap-widget-with-one-to-asset-id"></div>

        <script>
          KeeperSwapWidget.create(
            document.getElementById('swap-widget-with-one-to-asset-id'),
            {
              toAssetIds: ['DG2xFkPdDwKUoBkzGAhQtLpSGzfXLiCYPEzeKH2Ad24p'],
            }
          );
        </script>

        <form><input type="button" value="View code sample" onClick="viewSource('source-to-one-asset','KeeperSwapWidget\.create\(\n\ \ document\.getElementById\(\'\.\.\.\'\),\n\ \ \{\n\ \ \ \ toAssetIds\: \[\'...\'\],\n\ \ \ \ referrer\: \'...\'\,\n\ \ \}\n\);', 8)" ></form>

        <div id="source-to-one-asset"></div>

      </div>

      <div>
        <h3>Signer and address passed</h3>

        <p>This demo requires Keeper Wallet installed in your browser.</p>

        <script src="https://unpkg.com/@waves/signer@1.0.10/dist/signer.min.js"></script>
        <script src="https://unpkg.com/@waves/provider-keeper@0.2.5/dist/provider-keeper.js"></script>

        <p>
          <button id="connect-wallet-button" type="button">
            Connect wallet
          </button>

          <button id="disconnect-wallet-button" type="button" disabled>
            Disconnect wallet
          </button>
        </p>

        <div id="swap-widget-with-no-internal-signer"></div>

        <script>
          (() => {

            const signer = new window.signer.Signer();
            signer.setProvider(new window.providerKeeper.ProviderKeeper());

            const widget = KeeperSwapWidget.create(
              document.getElementById('swap-widget-with-no-internal-signer'),
              {
                useInternalSigner: false,
              }
            );

            const connectWalletButton = document.getElementById(
              'connect-wallet-button'
            );

            const disconnectWalletButton = document.getElementById(
              'disconnect-wallet-button'
            );

            connectWalletButton.addEventListener(
              'click',
              () => {
                connectWalletButton.disabled = true;
                disconnectWalletButton.disabled = false;

                signer.login().then(user => {
                  widget.setWallet({
                    address: user.address,
                    signer,
                  });
                });
              },
              false
            );

            disconnectWalletButton.addEventListener(
              'click',
              () => {
                connectWalletButton.disabled = false;
                disconnectWalletButton.disabled = true;

                widget.setWallet(null);
              },
              false
            );
          })();
        </script>

        <form><input type="button" value="View code sample" onClick="viewSource('source-external-signer','const signer = new window\.signer\.Signer\(\);\nsigner\.setProvider\(new window\.providerKeeper\.ProviderKeeper\(\)\)\;\n\nconst widget = KeeperSwapWidget\.create\(\n\ \ document\.getElementById\(\'\.\.\.\'\),\n\ \ \{\n\ \ \ \ useInternalSigner\: false\,\n\ \ \ \ referrer\: \'...\'\,\n\ \ \}\n\);\nsigner\.login\(\)\.then\(user =\> \{\n\ \ widget\.setWallet\(\{\n\ \ \ \ address: user\.address\,\n\ \ \ \ signer,\n\ \ \}\);\n\}\);', 17)" ></form>

        <div id="source-external-signer"></div>

      </div>
    </div>

    <h2 id="functions">Widget functions</h2>
    <ul>
      <li><tt>setWallet()</tt></li>
      <li><tt>destroy()</tt></li>
    </ul>

    <h3 id="functions">setWallet()</h3>

    <p>Use <tt>setWallet()</tt> to pass a user wallet to Keeper Swap Widget if Signer is implemented on your website.</p>

    <p>Connect the user wallet:</p>

    <pre><code>const signer = new window.signer.Signer();
signer.setProvider(...);

const widget = KeeperSwapWidget.create(...);

widget.setWallet({
  address,
  signer,
});</code></pre>

    <p>Disconnect the user wallet:</p>

    <pre><code>widget.setWallet(null);</code></pre>

    <h3 id="functions">destroy()</h3>

    Remove the widget if it is no longer needed:

    <pre><code>widget.destroy();</code></pre>

  </body>
</html>